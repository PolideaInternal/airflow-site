:mod:`airflow.gcp.operators.gcs`
================================

.. py:module:: airflow.gcp.operators.gcs

.. autoapi-nested-parse::

   This module contains a Google Cloud Storage Bucket operator.



Module Contents
---------------

.. py:class:: GoogleCloudStorageCreateBucketOperator(bucket_name:str, resource:Optional[Dict]=None, storage_class:str='MULTI_REGIONAL', location:str='US', project_id:Optional[str]=None, labels:Optional[Dict]=None, gcp_conn_id:str='google_cloud_default', google_cloud_storage_conn_id:Optional[str]=None, delegate_to:Optional[str]=None, *args, **kwargs)

   Bases: :class:`airflow.models.BaseOperator`

   Creates a new bucket. Google Cloud Storage uses a flat namespace,
   so you can't create a bucket with a name that is already in use.

       .. seealso::
           For more information, see Bucket Naming Guidelines:
           https://cloud.google.com/storage/docs/bucketnaming.html#requirements

   :param bucket_name: The name of the bucket. (templated)
   :type bucket_name: str
   :param resource: An optional dict with parameters for creating the bucket.
           For information on available parameters, see Cloud Storage API doc:
           https://cloud.google.com/storage/docs/json_api/v1/buckets/insert
   :type resource: dict
   :param storage_class: This defines how objects in the bucket are stored
           and determines the SLA and the cost of storage (templated). Values include

           - ``MULTI_REGIONAL``
           - ``REGIONAL``
           - ``STANDARD``
           - ``NEARLINE``
           - ``COLDLINE``.

           If this value is not specified when the bucket is
           created, it will default to STANDARD.
   :type storage_class: str
   :param location: The location of the bucket. (templated)
       Object data for objects in the bucket resides in physical storage
       within this region. Defaults to US.

       .. seealso:: https://developers.google.com/storage/docs/bucket-locations

   :type location: str
   :param project_id: The ID of the GCP Project. (templated)
   :type project_id: str
   :param labels: User-provided labels, in key/value pairs.
   :type labels: dict
   :param gcp_conn_id: (Optional) The connection ID used to connect to Google Cloud Platform.
   :type gcp_conn_id: str
   :param google_cloud_storage_conn_id: (Deprecated) The connection ID used to connect to Google Cloud
       Platform. This parameter has been deprecated. You should pass the gcp_conn_id parameter instead.
   :type google_cloud_storage_conn_id: str
   :param delegate_to: The account to impersonate, if any.
       For this to work, the service account making the request must
       have domain-wide delegation enabled.
   :type delegate_to: str

   The following Operator would create a new bucket ``test-bucket``
   with ``MULTI_REGIONAL`` storage class in ``EU`` region

   .. code-block:: python

       CreateBucket = GoogleCloudStorageCreateBucketOperator(
           task_id='CreateNewBucket',
           bucket_name='test-bucket',
           storage_class='MULTI_REGIONAL',
           location='EU',
           labels={'env': 'dev', 'team': 'airflow'},
           gcp_conn_id='airflow-conn-id'
       )

   .. attribute:: template_fields
      :annotation: = ['bucket_name', 'storage_class', 'location', 'project_id']

      

   .. attribute:: ui_color
      :annotation: = #f0eee4

      

   
   .. method:: execute(self, context)




.. py:class:: GoogleCloudStorageListOperator(bucket:str, prefix:Optional[str]=None, delimiter:Optional[str]=None, gcp_conn_id:str='google_cloud_default', google_cloud_storage_conn_id:Optional[str]=None, delegate_to:Optional[str]=None, *args, **kwargs)

   Bases: :class:`airflow.models.BaseOperator`

   List all objects from the bucket with the give string prefix and delimiter in name.

   This operator returns a python list with the name of objects which can be used by
    `xcom` in the downstream task.

   :param bucket: The Google cloud storage bucket to find the objects. (templated)
   :type bucket: str
   :param prefix: Prefix string which filters objects whose name begin with
          this prefix. (templated)
   :type prefix: str
   :param delimiter: The delimiter by which you want to filter the objects. (templated)
       For e.g to lists the CSV files from in a directory in GCS you would use
       delimiter='.csv'.
   :type delimiter: str
   :param gcp_conn_id: (Optional) The connection ID used to connect to Google Cloud Platform.
   :type gcp_conn_id: str
   :param google_cloud_storage_conn_id: (Deprecated) The connection ID used to connect to Google Cloud
       Platform. This parameter has been deprecated. You should pass the gcp_conn_id parameter instead.
   :type google_cloud_storage_conn_id:
   :param delegate_to: The account to impersonate, if any.
       For this to work, the service account making the request must have
       domain-wide delegation enabled.
   :type delegate_to: str

   **Example**:
       The following Operator would list all the Avro files from ``sales/sales-2017``
       folder in ``data`` bucket. ::

           GCS_Files = GoogleCloudStorageListOperator(
               task_id='GCS_Files',
               bucket='data',
               prefix='sales/sales-2017/',
               delimiter='.avro',
               gcp_conn_id=google_cloud_conn_id
           )

   .. attribute:: template_fields
      :annotation: :Iterable[str] = ['bucket', 'prefix', 'delimiter']

      

   .. attribute:: ui_color
      :annotation: = #f0eee4

      

   
   .. method:: execute(self, context)




.. py:class:: GoogleCloudStorageDownloadOperator(bucket:str, object_name:Optional[str]=None, filename:Optional[str]=None, store_to_xcom_key:Optional[str]=None, gcp_conn_id:str='google_cloud_default', google_cloud_storage_conn_id:Optional[str]=None, delegate_to:Optional[str]=None, *args, **kwargs)

   Bases: :class:`airflow.models.BaseOperator`

   Downloads a file from Google Cloud Storage.

   If a filename is supplied, it writes the file to the specified location, alternatively one can
   set the ``store_to_xcom_key`` parameter to True push the file content into xcom. When the file size
   exceeds the maximum size for xcom it is recommended to write to a file.

   :param bucket: The Google cloud storage bucket where the object is.
       Must not contain 'gs://' prefix. (templated)
   :type bucket: str
   :param object: The name of the object to download in the Google cloud
       storage bucket. (templated)
   :type object: str
   :param filename: The file path, including filename,  on the local file system (where the
       operator is being executed) that the file should be downloaded to. (templated)
       If no filename passed, the downloaded data will not be stored on the local file
       system.
   :type filename: str
   :param store_to_xcom_key: If this param is set, the operator will push
       the contents of the downloaded file to XCom with the key set in this
       parameter. If not set, the downloaded data will not be pushed to XCom. (templated)
   :type store_to_xcom_key: str
   :param gcp_conn_id: (Optional) The connection ID used to connect to Google Cloud Platform.
   :type gcp_conn_id: str
   :param google_cloud_storage_conn_id: (Deprecated) The connection ID used to connect to Google Cloud
       Platform. This parameter has been deprecated. You should pass the gcp_conn_id parameter instead.
   :type google_cloud_storage_conn_id: str
   :param delegate_to: The account to impersonate, if any.
       For this to work, the service account making the request must have
       domain-wide delegation enabled.
   :type delegate_to: str

   .. attribute:: template_fields
      :annotation: = ['bucket', 'object', 'filename', 'store_to_xcom_key']

      

   .. attribute:: ui_color
      :annotation: = #f0eee4

      

   
   .. method:: execute(self, context)




.. py:class:: GoogleCloudStorageDeleteOperator(bucket_name:str, objects:Optional[Iterable[str]]=None, prefix:Optional[str]=None, gcp_conn_id:str='google_cloud_default', google_cloud_storage_conn_id:Optional[str]=None, delegate_to:Optional[str]=None, *args, **kwargs)

   Bases: :class:`airflow.models.BaseOperator`

   Deletes objects from a Google Cloud Storage bucket, either
   from an explicit list of object names or all objects
   matching a prefix.

   :param bucket_name: The GCS bucket to delete from
   :type bucket_name: str
   :param objects: List of objects to delete. These should be the names
       of objects in the bucket, not including gs://bucket/
   :type objects: Iterable[str]
   :param prefix: Prefix of objects to delete. All objects matching this
       prefix in the bucket will be deleted.
   :param gcp_conn_id: (Optional) The connection ID used to connect to Google Cloud Platform.
   :type gcp_conn_id: str
   :param google_cloud_storage_conn_id: (Deprecated) The connection ID used to connect to Google Cloud
       Platform. This parameter has been deprecated. You should pass the gcp_conn_id parameter instead.
   :type google_cloud_storage_conn_id: str
   :param delegate_to: The account to impersonate, if any.
       For this to work, the service account making the request must have
       domain-wide delegation enabled.
   :type delegate_to: str

   .. attribute:: template_fields
      :annotation: = ['bucket_name', 'prefix', 'objects']

      

   
   .. method:: execute(self, context)




.. py:class:: GoogleCloudStorageBucketCreateAclEntryOperator(bucket:str, entity:str, role:str, user_project:Optional[str]=None, gcp_conn_id:str='google_cloud_default', google_cloud_storage_conn_id:Optional[str]=None, *args, **kwargs)

   Bases: :class:`airflow.models.BaseOperator`

   Creates a new ACL entry on the specified bucket.

   .. seealso::
       For more information on how to use this operator, take a look at the guide:
       :ref:`howto/operator:GoogleCloudStorageBucketCreateAclEntryOperator`

   :param bucket: Name of a bucket.
   :type bucket: str
   :param entity: The entity holding the permission, in one of the following forms:
       user-userId, user-email, group-groupId, group-email, domain-domain,
       project-team-projectId, allUsers, allAuthenticatedUsers
   :type entity: str
   :param role: The access permission for the entity.
       Acceptable values are: "OWNER", "READER", "WRITER".
   :type role: str
   :param user_project: (Optional) The project to be billed for this request.
       Required for Requester Pays buckets.
   :type user_project: str
   :param gcp_conn_id: (Optional) The connection ID used to connect to Google Cloud Platform.
   :type gcp_conn_id: str
   :param google_cloud_storage_conn_id: (Deprecated) The connection ID used to connect to Google Cloud
       Platform. This parameter has been deprecated. You should pass the gcp_conn_id parameter instead.
   :type google_cloud_storage_conn_id: str

   .. attribute:: template_fields
      :annotation: = ['bucket', 'entity', 'role', 'user_project']

      

   
   .. method:: execute(self, context)




.. py:class:: GoogleCloudStorageObjectCreateAclEntryOperator(bucket:str, object_name:str, entity:str, role:str, generation:Optional[int]=None, user_project:Optional[str]=None, gcp_conn_id:str='google_cloud_default', google_cloud_storage_conn_id:Optional[str]=None, *args, **kwargs)

   Bases: :class:`airflow.models.BaseOperator`

   Creates a new ACL entry on the specified object.

   .. seealso::
       For more information on how to use this operator, take a look at the guide:
       :ref:`howto/operator:GoogleCloudStorageObjectCreateAclEntryOperator`

   :param bucket: Name of a bucket.
   :type bucket: str
   :param object_name: Name of the object. For information about how to URL encode object
       names to be path safe, see:
       https://cloud.google.com/storage/docs/json_api/#encoding
   :type object_name: str
   :param entity: The entity holding the permission, in one of the following forms:
       user-userId, user-email, group-groupId, group-email, domain-domain,
       project-team-projectId, allUsers, allAuthenticatedUsers
   :type entity: str
   :param role: The access permission for the entity.
       Acceptable values are: "OWNER", "READER".
   :type role: str
   :param generation: Optional. If present, selects a specific revision of this object.
   :type generation: long
   :param user_project: (Optional) The project to be billed for this request.
       Required for Requester Pays buckets.
   :type user_project: str
   :param gcp_conn_id: (Optional) The connection ID used to connect to Google Cloud Platform.
   :type gcp_conn_id: str
   :param google_cloud_storage_conn_id: (Deprecated) The connection ID used to connect to Google Cloud
       Platform. This parameter has been deprecated. You should pass the gcp_conn_id parameter instead.
   :type google_cloud_storage_conn_id: str

   .. attribute:: template_fields
      :annotation: = ['bucket', 'object_name', 'entity', 'generation', 'role', 'user_project']

      

   
   .. method:: execute(self, context)




.. py:class:: GcsFileTransformOperator(source_bucket:str, source_object:str, transform_script:Union[str, List[str]], destination_bucket:Optional[str]=None, destination_object:Optional[str]=None, gcp_conn_id:str='google_cloud_default', *args, **kwargs)

   Bases: :class:`airflow.models.BaseOperator`

   Copies data from a source GCS location to a temporary location on the
   local filesystem. Runs a transformation on this file as specified by
   the transformation script and uploads the output to a destination bucket.
   If the output bucket is not specified the original file will be
   overwritten.

   The locations of the source and the destination files in the local
   filesystem is provided as an first and second arguments to the
   transformation script. The transformation script is expected to read the
   data from source, transform it and write the output to the local
   destination file.

   :param source_bucket: The key to be retrieved from S3. (templated)
   :type source_bucket: str
   :param destination_bucket: The key to be written from S3. (templated)
   :type destination_bucket: str
   :param transform_script: location of the executable transformation script or list of arguments
       passed to subprocess ex. `['python', 'script.py', 10]`. (templated)
   :type transform_script: Union[str, List[str]]
   :param gcp_conn_id: The connection ID to use connecting to Google Cloud Platform.
   :type gcp_conn_id: str

   .. attribute:: template_fields
      :annotation: = ['source_bucket', 'destination_bucket', 'transform_script']

      

   
   .. method:: execute(self, context:Dict)




